#include "EnginePCH.hpp" // PCH

// Custom includes:
#include <SAMP-EDGEngine/Server/GameMode.hpp>
#include <SAMP-EDGEngine/World/Streamer/Streamer.hpp>

namespace samp_edgengine
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
IGameMode::IGameMode()
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
IGameMode::~IGameMode()
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
UniquePtr<Player> IGameMode::newPlayerInstance(Int32 playerIndex_) const
{
	return std::make_unique<Player>(playerIndex_);
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void IGameMode::addPlayerClass(std::size_t modelIndex_, math::Vector3f const location_, float const facingAngle_, std::array<Weapon, 3> weapons_)
{
	sampgdk_AddPlayerClass(modelIndex_, location_.x, location_.y, location_.z, facingAngle_,
		static_cast<Int32>(weapons_[0].getType()), weapons_[0].getAmmo(),
		static_cast<Int32>(weapons_[1].getType()), weapons_[1].getAmmo(),
		static_cast<Int32>(weapons_[2].getType()), weapons_[2].getAmmo());
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void IGameMode::setup()
{
	this->setupStreamer();
	this->setupEvents();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void IGameMode::setupStreamer()
{
	Streamer = std::make_unique<default_streamer::Streamer>();
}

}
